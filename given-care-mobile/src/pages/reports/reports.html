<ion-header>
  <ion-navbar>
    <a href="http://twitter.com/utiletipping" target="_blank" end ion-button menuToggle>
      <ion-icon name="logo-twitter"></ion-icon>
    </a>
    <button end ion-button menuToggle>
      <ion-icon name="menu"></ion-icon>
    </button>
    <ion-title>Un pépin à signaler ?</ion-title>
  </ion-navbar>
</ion-header>

<ion-content>

        <ion-grid *ngIf="!cameraOpen" style="height: 100%">
          <ion-row style="height: 50%">
            <ion-img width="100%" height="auto" [src]="'/assets/souci.png'"></ion-img>
          </ion-row>

            <ion-row style="height: 50%">
              <ion-grid>

                <ion-row *ngIf="!emergency">
                  <ion-col col-1></ion-col>
                  <ion-col col-10>
                    <button (click)="emergencyCall()" style="text-transform: none;" ion-button color="danger" ion-col col-12>
                      Alerte !!!
                    </button>
                  </ion-col>
                </ion-row>

                  <ion-row *ngIf="!emergency">
                    <ion-col col-1></ion-col>
                    <ion-col col-10>
                      <button (click)='prepareReport("restroomFull")' class="button-report" style="text-transform: none;" ion-button ion-col col-12>
                      Les toilettes n'ont plus de papier/copeaux
                      </button>
                    </ion-col>
                  </ion-row>

                  <ion-row *ngIf="!emergency">
                    <ion-col col-1></ion-col>
                    <ion-col col-10>
                      <button (click)='prepareReport("trashCanFull")' class="button-report" style="text-transform: none;" ion-button ion-col col-12>
                        La poubelle est pleine
                      </button>
                    </ion-col>
                  </ion-row>

                  <ion-row *ngIf="!emergency">
                    <ion-col col-1></ion-col>
                    <ion-col col-10>
                      <button (click)='prepareReport("unknown")' style="text-transform: none;" ion-button ion-col col-12>
                        Autre
                      </button>
                    </ion-col>
                  </ion-row>

                </ion-grid>
            </ion-row>
          </ion-grid>

          <ion-grid *ngIf="emergency">
            <div *ngIf='callNow' class='alarm'>
              <img [src]="'/assets/alarm.gif'" alt='Alarm !!!' />
            </div>
            <img [ngClass]="callNow ? 'david-fast' : 'david'" class="" style="position: absolute; right: 30px; bottom: 30px; " [src]="'/assets/david.png'" #david/>
          </ion-grid>

  <ion-grid *ngIf="cameraOpen">
      <ion-row *ngIf="!photoTaken">
        <video width="100%" height="auto" autoplay controls #videoPlayer>
          Browser not supported
        </video>

        <button style="position : absolute; bottom : 10px; text-align: center;" ion-button (click)="snap()">Take Photo</button>
      </ion-row>
      <ion-row [style.display]="photoTaken ? '' : 'none'">
        <canvas width="320px" height="240px" #canvasImg></canvas>
        <button ion-button (click)="sendReport()">Send Photo</button>
      </ion-row>
  </ion-grid>
</ion-content>

<ion-footer>
  <ion-toolbar>
    <ion-grid>
      <ion-row>
        <ion-col></ion-col>
        <ion-col><button ion-button color="light" style="width: 100%" (click)="cancel()">Annuler</button></ion-col>
        <ion-col></ion-col>
      </ion-row>
    </ion-grid>
  </ion-toolbar>
</ion-footer>
